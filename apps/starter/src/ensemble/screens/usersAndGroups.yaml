View:
  onLoad:
    invokeApi:
      name: getData
      onResponse:
        executeCode:
          body: |
            ensemble.storage.set("arrayOfUsers",response.body.records)
            console.log(ensemble.storage.get("arrayOfUsers"))
            const groups = new Set(response.body.records.flatMap(record => record.fields.groups))
            // ensemble.storage.set("arrayOfGroups", Array.from(groups))
            console.log("ensemble.formatter");
            console.log(ensemble.formatter.now().getDate());
            console.log(ensemble.formatter.now().getDateTime());
            console.log(ensemble.formatter.now().getYear());
            console.log(ensemble.formatter.now().getMonth());
            console.log(ensemble.formatter.now().getDay());
            console.log(ensemble.formatter.now().getDayOfWeek());
            console.log(ensemble.formatter.now().getHour());
            console.log(ensemble.formatter.now().getMinute());
            console.log(ensemble.formatter.now().getSecond());
            console.log(ensemble.formatter.now().getMilliseconds());
            console.log(ensemble.formatter.now().prettyDateTime());
            console.log(ensemble.formatter.now().prettyDate());
            console.log(ensemble.formatter.now().prettyTime());
            console.log(ensemble.formatter.prettyDateTime("2021-08-10T12:00:00.000Z"));
            console.log(ensemble.formatter.prettyDate("2021-08-10T12:00:00.000Z"));
            console.log(ensemble.formatter.prettyTime("2021-08-10T12:00:00.000Z"));
            console.log(ensemble.formatter.prettyDuration("100000000"));
          onComplete:
            executeCode:
              scriptName: test.js
  header:
    title:
      Header:
  body:
    Column:
      id: root
      styles:
        height: 100%
        crossAxis: stretch
      children:
        - Column:
            styles:
              padding: 0 40px
              backgroundColor: "#FEFEFE"
            children:
              - Markdown:
                  styles:
                    names: font-black
                  text: "# User Management"
              - TabBar:
                  id: tababr1
                  selectedIndex: 0
                  items:
                    - label: ${ "Groups(" + getData.body.records.length +")"}
                      widget:
                        Column:
                          children:
                            - Row:
                                mainAxis: spaceBetween
                                children:
                                  - Search:
                                      styles:
                                        width: 320px
                                        height: 40px
                                        borderRadius: 12
                                        borderWidth: 2
                                        borderStyle: solid
                                        borderColor: "#B8BED6"
                                      placeholder: Search
                                      data: getData.body.records
                                      searchKey: email
                                  - Button:
                                      label: Create new group
                                      styles:
                                        textColor: white
                                        backgroundColor: black
                                        padding: 16
                                      gap: 6
                                      startingIcon:
                                        name: Add
                                        color: white
                                        size: 22
                                      onTap:
                                        navigateModalScreen:
                                          name: Create Group
                                          inputs:
                                            message: ${"hello" + getData.body.records.length}
                                          maskClosable: false
                                          styles:
                                            position: right
                                            height: 100%
                                            width: 70%
                            - Conditional:
                                conditions:
                                  - if: ${!getData.body.records}
                                    Column:
                                      mainAxis: center
                                      crossAxis: center
                                      gap: 24
                                      children:
                                        - Column:
                                            crossAxis: center
                                            gap: 24
                                            children:
                                              - Column:
                                                  styles:
                                                    width: 200
                                                    height: 200
                                                    backgroundColor: "#D9D9D9"
                                                    borderRadius: 100
                                                  children:
                                                    - Text:
                                                        text:
                                              - Column:
                                                  crossAxis: center
                                                  children:
                                                    - Text:
                                                        text: Organize users into groups
                                                        styles:
                                                          fontSize: 22
                                                          color: black
                                                          fontWeight: 600
                                                    - Text:
                                                        text: Grant users messaging access by adding them to groups.

                                              - Button:
                                                  label: Create new group
                                                  styles:
                                                    textColor: white
                                                    backgroundColor: black
                                                    padding: 16
                                                  gap: 6
                                                  startingIcon:
                                                    name: Add
                                                    color: white
                                                    size: 22
                                                  onTap:
                                                    navigateModalScreen:
                                                      name: Create Group
                                                      maskClosable: false
                                                      inputs:
                                                        message: ${"hello" + getData.body.records.length}

                                  - else:
                                    GridView:
                                      item-template:
                                        data: ${getData.body.records}
                                        name: user
                                        template:
                                          Card:
                                            styles:
                                              shadowColor: lightgrey
                                              shadowOffset: 8px
                                              shadowBlur: 10px
                                              shadowSpread: -2px
                                              backgroundColor: white
                                              minWidth: 90%
                                              maxWidth: 90%
                                            children:
                                              - Column:
                                                  children:
                                                    - Avatar:
                                                        styles:
                                                          backgroundColor: "#D9D9D9"
                                                        alt: abc
                                                        name: ${user.fields.name}

                                                    - Column:
                                                        styles:
                                                          crossAxis: center
                                                          gap: 5
                                                          marginTop: 20px
                                                        children:
                                                          - Column:
                                                              styles:
                                                                crossAxis: start
                                                              children:
                                                                - Text:
                                                                    id: ${"name" + user.id}
                                                                    text: ${user.fields.name}
                                                                - Text:
                                                                    text: ${user.fields.email}

                    - label: All Users
                      widget:
                        Row:
                          children:
                            - Column:
                                children:
                                  - Row:
                                      mainAxis: spaceBetween
                                      gap: 20
                                      children:
                                        - Search:
                                            styles:
                                              width: 320px
                                              height: 40px
                                              borderRadius: 12
                                              borderWidth: 2
                                              borderStyle: solid
                                              borderColor: "#B8BED6"
                                            placeholder: Search
                                            data: getData.body.records
                                            searchKey: email
                                        - Button:
                                            label: Invite
                                            styles:
                                              textColor: white
                                              backgroundColor: "#072CC4"
                                              padding: 16
                                            gap: 6
                                            startingIcon:
                                              name: Add
                                              color: white
                                              size: 22
                                            onTap:
                                              navigateModalScreen:
                                                name: Invite
                                                maskClosable: false
                                  - DataGrid:
                                      id: myGrid
                                      DataColumns:
                                        - label: User
                                        - label: Role
                                        - label: Groups
                                        - label: Last Active
                                      item-template:
                                        data: getData.body.records
                                        name: user
                                        template:
                                          DataRow:
                                            children:
                                              # Person
                                              - Row:
                                                  crossAxis: center
                                                  mainAxis: spaceBetween
                                                  gap: 5
                                                  children:
                                                    - Avatar:
                                                        styles:
                                                          backgroundColor: "#D9D9D9"
                                                        name: ${user.fields.name}
                                                    - Column:
                                                        crossAxis: start
                                                        children:
                                                          - Text:
                                                              text: ${user.fields.name}
                                                          - Text:
                                                              text: ${user.fields.email}
                                              - Text:
                                                  text: user

                                              # MoM
                                              - Row:
                                                  crossAxis: center
                                                  gap: 10
                                                  children:
                                                    - Tag:
                                                        label: Administration
                                                        icon:
                                                          name: CloseOutlined
                                                        styles:
                                                          backgroundColor: "#FBF8EC"
                                                          borderRadius: 2
                                                    - Tag:
                                                        label: Human Resource
                                                        icon:
                                                          name: CloseOutlined
                                                        styles:
                                                          backgroundColor: "#FBF8EC"
                                                          borderRadius: 2

                                              - Row:
                                                  mainAxis: spaceBetween
                                                  children:
                                                    - Text:
                                                        text: 1 day ago
                                                    - PopupMenu:
                                                        items:
                                                          - {
                                                              "label": "View",
                                                              "value": "red",
                                                            }
                                                          - {
                                                              "label": "Remove",
                                                              "value": "blue",
                                                            }
                                                          - {
                                                              "label": "Message",
                                                              "value": "green",
                                                            }
                                                        onItemSelect:
                                                          navigateModalScreen:
                                                            name: Ask Embrace
                                                        widget:
                                                          Icon:
                                                            name: MoreVert
                    - label: Contributors
                      widget:
                        Column:
                          children:
                            - Row:
                                gap: 20
                                mainAxis: start
                                crossAxis: center
                                children:
                                  - Search:
                                      styles:
                                        width: 320px
                                        height: 40px
                                        borderRadius: 5
                                        borderWidth: 2
                                        borderStyle: solid
                                        borderColor: "#D0D0D0"
                                      data: getData.body.users
                                      searchKey: email
                                  - Button:
                                      label: Invite Contributor
                                      startingIcon:
                                        name: AddOutlined
                                      onTap:
                                        navigateModalScreen:
                                          name: Ask Embrace
                                          maskClosable: false
                                      styles:
                                        backgroundColor: white
                                        borderColor: black
                                        borderRadius: 5
                                        borderWidth: 1px
                            - Row:
                                children:
                                  - DataGrid:
                                      DataColumns:
                                        - label: User
                                        - label: Groups
                                        - label: Collection Access
                                        - label: Last Active
                                      item-template:
                                        data: getData.body.records
                                        name: user
                                        template:
                                          DataRow:
                                            children:
                                              # Person
                                              - Row:
                                                  crossAxis: center
                                                  gap: 15
                                                  minWidth: 250px
                                                  children:
                                                    - Avatar:
                                                        alt: sana
                                                        name: ${user.fields.name}
                                                        styles:
                                                          backgroundColor: "#F4F4F4"
                                                          color: grey
                                                    - Column:
                                                        crossAxis: start
                                                        children:
                                                          - Text:
                                                              text: ${user.fields.name}
                                                          - Text:
                                                              text: ${user.fields.email}
                                                              styles:
                                                                fontWeight: normal
                                                                fontSize: 12px
                                                                color: "#767676"
                                              - Row:
                                                  crossAxis: center
                                                  gap: 10
                                                  maxWidth: 400px
                                                  children:
                                                    - Tag:
                                                        label: ${user.fields.groups}
                                                        styles:
                                                          backgroundColor: "#FBF8EC"
                                                          borderRadius: 8

                                              # MoM
                                              - Row:
                                                  crossAxis: center
                                                  gap: 10
                                                  children:
                                                    - Tag:
                                                        label: ${user.fields.collection_access}
                                                        styles:
                                                          backgroundColor: "#E9ECF4"
                                                          borderRadius: 8

                                              - Row:
                                                  mainAxis: spaceBetween
                                                  styles:
                                                    flexWrap: nowrap
                                                  children:
                                                    - Text:
                                                        text: ${user.fields.last_Active}
                                                        styles:
                                                          fontWeight: normal
                                                          fontSize: 12px
                                                          color: "#767676"
                                                    - PopupMenu:
                                                        items:
                                                          - {
                                                              "label": "View",
                                                              "value": "red",
                                                            }
                                                          - {
                                                              "label": "Remove",
                                                              "value": "blue",
                                                            }
                                                          - {
                                                              "label": "Message",
                                                              "value": "green",
                                                            }
                                                        onItemSelect:
                                                          executeCode: console.log(value)
                                                        widget:
                                                          Icon:
                                                            name: MoreVert

                    - label: Admins
                      widget:
                        Column:
                          children:
                            - Row:
                                gap: 20
                                mainAxis: start
                                crossAxis: center
                                children:
                                  - Search:
                                      styles:
                                        width: 320px
                                        height: 40px
                                        borderRadius: 5
                                        borderWidth: 2
                                        borderStyle: solid
                                        borderColor: "#D0D0D0"
                                      data: getData.body.users
                                      searchKey: email
                                  - Button:
                                      label: Invite Admin
                                      startingIcon:
                                        name: AddOutlined
                                      onTap:
                                        navigateModalScreen:
                                          name: Ask Embrace
                                          maskClosable: false
                                      styles:
                                        backgroundColor: white
                                        borderColor: black
                                        borderRadius: 5
                                        borderWidth: 1px
                            - DataGrid:
                                DataColumns:
                                  - label: User
                                  - label: Last Active
                                item-template:
                                  data: getData.body.records
                                  name: user
                                  template:
                                    DataRow:
                                      children:
                                        # Person
                                        - Row:
                                            crossAxis: center
                                            gap: 15
                                            children:
                                              - Avatar:
                                                  alt: sana
                                                  name: ${user.fields.name}
                                                  styles:
                                                    backgroundColor: "#F4F4F4"
                                                    color: grey
                                              - Column:
                                                  crossAxis: start
                                                  children:
                                                    - Text:
                                                        text: ${user.fields.name}
                                                    - Text:
                                                        text: ${user.fields.email}
                                                        styles:
                                                          fontWeight: normal
                                                          fontSize: 12px
                                                          color: "#767676"
                                        - Text:
                                            text: ${user.fields.last_Active}
                                            styles:
                                              fontWeight: normal
                                              fontSize: 12px
                                              color: "#767676"
              - Column:
                  item-template:
                    data: ensemble.storage.get("arrayOfUsers")
                    name: usr
                    template:
                      Row:
                        gap: 5
                        children:
                          - Text:
                              text: ${usr.fields.name}
                          - Column:
                              item-template:
                                data: usr.fields.groups
                                name: n1
                                template:
                                  Text:
                                    text: ${n1}
        - Dropdown:
            id: myDropDown
            hintText: Select a program
            value: ${ensemble.storage.get("arrayOfUsers")[0].fields.name}
            items:
              - label: ${ensemble.storage.get("arrayOfUsers")[0].fields.name}
                value: ${ensemble.storage.get("arrayOfUsers")[0].fields.name}
              - label: HELLO
                value: hello
            onItemSelect:
              executeCode: |
                console.log("New value", selectedValue);
        - Divider:
            styles:
              thickness: 1
              color: black
              width: 100px
        - Progress:
            display: linear
            filledPercentage: 80
            styles:
              color: green
              backgroundColor: black
              thickness: 24
              borderRadius: 100px
API:
  getData:
    uri: https://api.airtable.com/v0/app0FnT5yUsW9fjn6/tblWGM6o7vqlTfB8b
    method: GET
    headers:
      Authorization: Bearer patN2XAiLVZQ8Yp3h.2bddb84031b2be89b576f01869dc17c3826e16ae7daa8895f92c05a0799004ab
  searchUsers:
    uri: https://dummyjson.com/users/search?q=${search}
    method: GET
    inputs:
      - search
