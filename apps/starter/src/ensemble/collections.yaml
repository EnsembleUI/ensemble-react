View:
  onLoad:
    invokeApi:
      name: getData
      onResponse:
        executeCode: |
          ensemble.storage.set("arrayOfUsers",response.body.records)
          const groups = new Set(response.body.records.flatMap(record => record.fields.groups))
          ensemble.storage.set("arrayOfGroups", Array.from(groups))
  body:
    Column:
      styles:
        crossAxis: stretch
        margin: 0 20px
      children:
        - Row:
            mainAxis: spaceBetween
            crossAxis: center
            children:
              - Markdown:
                  text: "# Collections"
        - Column:
            children:      
              - Row:
                  mainAxis: spaceBetween
                  crossAxis: center
                  children:
                    - Search:
                        styles:
                          width: 320px
                          height: 40px
                          borderRadius: 12
                          borderWidth: 2
                          borderStyle: solid
                          borderColor: "#B8BED6"
                        placeholder: Search
                        data: getData.body.records
                        searchKey: email
                    - Button:
                        label: Create Collection
                        onTap:
                          navigateModalScreen:
                            name: Ask Embrace
                            maskClosable: false
              
              - Conditional:
                  conditions:
                    - if: ${!getData.body.records}
                      Column:
                        mainAxis: center
                        crossAxis: center
                        gap: 24
                        children:
                          - Column:
                              crossAxis: center
                              gap: 24
                              children:
                                - Column:
                                    styles:
                                      width: 200
                                      height: 200
                                      backgroundColor: "#D9D9D9"
                                      borderRadius: 100
                                    children:
                                      - Text:
                                          text:
                                - Column:
                                    crossAxis: center
                                    children:
                                      - Text:
                                          text: Organize users into groups
                                          styles:
                                            fontSize: 22
                                            color: black
                                            fontWeight: 600
                                      - Text:
                                          text: Grant users messaging access by adding them to groups.

                                - Button:
                                    label: Create new group
                                    styles:
                                      textColor: white
                                      backgroundColor: black
                                      padding: 16
                                    gap: 6
                                    startingIcon:
                                      name: Add
                                      color: white
                                      size: 22
                                    onTap:
                                      navigateModalScreen:
                                        name: Create Group
                                        maskClosable: false

                    - else:
                      GridView:
                        item-template:
                          data: getData.body.records
                          name: user
                          template:
                            Card:
                              styles:
                                shadowColor: lightgrey
                                shadowOffset: 8px
                                shadowBlur: 10px
                                shadowSpread: -2px
                                backgroundColor: white
                              children:
                                - Column:
                                    children:
                                      - Conditional:
                                          conditions:
                                            - if: ${!user.fields.image}
                                              Avatar:
                                                styles:
                                                  backgroundColor: "#D9D9D9"
                                                alt: abc
                                                name: ${user.fields.name}                                                           
                                            - else:
                                              Image:
                                                source: ${user.fields.image}
                                                width: 30
                                                height: 30
                                                fit: cover
                                                borderRadius: 10
                                                backgroundColor: ${user.fields.imageBackgroundColor}
                                                padding: 5
                                      - Column:
                                          styles:
                                            crossAxis: center
                                            gap: 5
                                            marginTop: 20px
                                          children:
                                            - Column:
                                                styles:
                                                  crossAxis: start
                                                children:
                                                  - Text:
                                                      text: ${user.fields.name}
                                                  - Text:
                                                      text: ${user.fields.email}
              

              
        


API:
  getData:    
    uri: https://api.airtable.com/v0/app0FnT5yUsW9fjn6/tblWGM6o7vqlTfB8b
    method: GET
    headers:
      Authorization: Bearer patN2XAiLVZQ8Yp3h.2bddb84031b2be89b576f01869dc17c3826e16ae7daa8895f92c05a0799004ab
