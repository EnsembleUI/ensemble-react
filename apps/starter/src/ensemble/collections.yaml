View:
  onLoad:
    invokeApi:
      name: getData
      onResponse:
        executeCode: |
          ensemble.storage.set("arrayOfUsers",response.body.records)
          const groups = new Set(response.body.records.flatMap(record => record.fields.groups))
          ensemble.storage.set("arrayOfGroups", Array.from(groups))
  body:
    Column:
      crossAxis: stretch
      margin: 0 20px
      gap: 10
      children:
        - Row:
            mainAxis: spaceBetween
            crossAxis: center
            children:
              - Markdown:
                  text: "# Collections"
        - Row:
            mainAxis: spaceBetween
            crossAxis: center
            children:
              - Search:
                  styles:
                    width: 320px
                    height: 40px
                    borderRadius: 12
                    borderWidth: 2
                    borderStyle: solid
                    borderColor: "#B8BED6"
                  placeholder: Search
                  data: getData.body.records
                  searchKey: email
              - Button:
                  label: Create Collection
                  onTap:
                    navigateModalScreen:
                      name: Ask Embrace
                      maskClosable: false

        - Conditional:
            conditions:
              - if: ${!getData.body.records}
                Row:
                  crossAxis: center
                  gap: 24
                  children:
                    - Card:
                        styles:
                          shadowColor: lightgrey
                          shadowOffset: 8px
                          shadowBlur: 10px
                          shadowSpread: -2px
                          backgroundColor: white
                        children:
                          - Column:
                              crossAxis: start
                              gap: 24
                              children:
                                - Text:
                                    text: ðŸ“‚
                                    styles:
                                      fontSize: 32
                                - Column:
                                    styles:
                                      crossAxis: center
                                    children:
                                      - Text:
                                          text: Add your first collection
                                          styles:
                                            fontSize: 26
                                            fontWeight: 600
                                            color: "#28304B"
                                            fontFamily: Inter
                                      - Text:
                                          text: Create a new collection to start adding content to your knowledge base.
                                          styles:
                                            fontSize: 15
                                            fontWeight: 400
                                            color: "#565D80"
                                            fontFamily: Inter
                                - Button:
                                    label: Create collection
                                    startingIcon:
                                      name: Add
                                      color: white
                                      size: 22
                                    onTap:
                                      navigateModalScreen:
                                        name: Create Group
                                        maskClosable: false

              - else:
                GridView:
                  item-template:
                    data: getData.body.records
                    name: user
                    template:
                      Card:
                        styles:
                          shadowColor: lightgrey
                          shadowOffset: 8px
                          shadowBlur: 10px
                          shadowSpread: -2px
                          backgroundColor: white
                        children:
                          - Column:
                              gap: 10
                              children:
                                - Conditional:
                                    conditions:
                                      - if: ${!user.fields.icon}
                                        Avatar:
                                          styles:
                                            backgroundColor: "#D9D9D9"
                                          alt: abc
                                          name: ${user.fields.Title}
                                      - else:
                                        Image:
                                          source: ${user.fields.icon}
                                          width: 30
                                          height: 30
                                          fit: cover
                                          borderRadius: 10
                                          backgroundColor: ${user.fields.backgroundColor}
                                          padding: 5
                                - Column:
                                    styles:
                                      crossAxis: center
                                      gap: 5
                                      marginTop: 20px
                                    children:
                                      - Column:
                                          styles:
                                            crossAxis: start
                                          children:
                                            - Text:
                                                text: ${user.fields.Title}
                                                styles: 
                                                  fontSize: 16
                                                  fontWeight: 700
                                            - Text:
                                                text: ${user.fields.sources}
                                - Row:
                                    crossAxis: start
                                    mainAxis: start
                                    gap: 10
                                    children:
                                      - Tag:
                                          label: ${user.fields.Tags}
                                          styles:
                                            backgroundColor: "#ebedf0"
                                            borderRadius: 1
                                - Divider:
                                    styles:
                                      thickness: 1
                                      color: "#ECEFF6"

                                - Row:
                                    gap: 8
                                    crossAxis: center
                                    children:
                                      - Icon:
                                          name: CheckCircleOutlineOutlined
                                          size: 15
                                          color: "#87888a"
                                      - Text:
                                          text: ${user.fields.Status}
                                          styles:
                                            color: "#87888a"
                                            fontSize: 13

                                - Row:
                                    gap: 8
                                    crossAxis: center
                                    children:
                                      - Icon: 
                                          name: CachedOutlined
                                          size: 15
                                          color: "#87888a"
                                      - Text:
                                          text: ${user.fields.last_active}
                                          styles:
                                            color: "#87888a"
                                            fontSize: 13

              

              
        


API:
  getData:
    uri: https://api.airtable.com/v0/app4U7TLRbZKGKYWd/tbl6STCIq92xFop9T
    method: GET
    headers:
      Authorization: Bearer patN2XAiLVZQ8Yp3h.2bddb84031b2be89b576f01869dc17c3826e16ae7daa8895f92c05a0799004ab
