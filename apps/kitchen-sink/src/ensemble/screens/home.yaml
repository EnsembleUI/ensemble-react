View:
  onLoad:
    executeCode:
      body: |
        ensemble.storage.set('yyy' , 'page')
        ensemble.storage.set('zzz' , 'button')
        ensemble.storage.set('aaa' , '1')
      onComplete:
        executeActionGroup:
          actions:
            - executeCode: |
                ensemble.storage.set('managerIsLoading', true);
            - executeCode:
                scriptName: aiChatMessage.js
            - executeCode:
                scriptName: setAdvocate.js
            - invokeAPI:
                name: getDummyProducts
                onResponse:
                  executeActionGroup:
                    actions:
                      - invokeAPI:
                          name: getMockProducts
                          inputs:
                            sortBy: id
                            sortOrder: desc
                          onResponse:
                            executeCode: |
                              const tasks = response.body.map(({id})=> id)
                              ensemble.storage.set('managerTasks', tasks)
                              ensemble.storage.set('cursors', Array(response.body.length).fill())
                              ensemble.storage.set('managerIsLoading', false);
                      - invokeAPI:
                          name: getDummyNumbers

  header:
    title:
      Header:

  styles:
    backgroundColor: ${colors.primary['200']}

  body:
    Column:
      styles:
        names: ${ensemble.storage.get('yyy')}
      children:
        - Text:
            styles:
              names: heading-1
              color: ${colors.primary['900']}
            text: The Kitchen Sink
        - Markdown:
            text: This application is built with Ensemble and serves as a guide for how to implement common UI patterns with Ensemble React.
        - Button:
            styles:
              className: page-1 ${ensemble.storage.get('zzz') + '-' + ensemble.storage.get('aaa')}
            label: ${productTitleName}
            onTap:
              executeCode: |
                // Calls a function defined in test.js
                sayHello();

        - Text:
            styles:
              names: heading-1
            text: Change theme
        - PopupMenu:
            showDivider: true
            items:
              - label: Light
                value: default
              - label: Dark
                value: dark
            widget:
              Icon:
                name: Settings
            onItemSelect:
              executeCode: |
                ensemble.setTheme(value)

Global:
  scriptName: test.js

Import:
  - common

API:
  getDummyProducts:
    method: GET
    uri: https://dummyjson.com/products

  getMockProducts:
    method: GET
    uri: https://661e111b98427bbbef034208.mockapi.io/products?sortBy=${sortBy}&order=${sortOrder}&limit=10
    inputs:
      - sortBy
      - sortOrder

  getDummyNumbers:
    method: GET
    uri: https://661e111b98427bbbef034208.mockapi.io/number?limit=10
    onResponse:
      executeCode: |
        console.log('dummy number fetched')
