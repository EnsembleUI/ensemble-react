View:
  onLoad:
    invokeAPI:
      name: getDummyProducts
      inputs:
        skip: 10
      onResponse:
        executeCode: |
          const res = response.body.products;
          ensemble.storage.set("skip", 10)
          ensemble.storage.set("products", res)
  header:
    title:
      Header:

  body:
    Column:
      styles:
        names: page
      children:
        - Text:
            styles:
              names: heading-1
            text: Layouts
        - Markdown:
            text: This screen demonstrates a few patterns to get you started with Ensemble. Here, we fetch data from an API and use control expressions to display a loading state and a list of products. Try making a few changes and see how the screen automatically updates! For more information, see [help](/help).
        - Text:
            styles:
              names: heading-3
            text: My Products
        - Column:
            children:
              - GridView:
                  styles:
                    maxHeight: 200px
                    overflow: auto
                  onScrollEnd:
                    # here you can add your page update logic
                    invokeAPI:
                      name: getDummyProducts
                      inputs:
                        skip: ${ensemble.storage.get('skip') + 10}
                      onResponse:
                        executeCode: |
                          const prevItem = ensemble.storage.get("products")
                          const res = response.body.products;
                          ensemble.storage.set("skip", ensemble.storage.get('skip') + 10)
                          ensemble.storage.set("products", [...prevItem, ...res])
                  item-template:
                    data: ${ensemble.storage.get("products")}
                    name: product
                    template:
                      Card:
                        children:
                          - Text:
                              text: ${product.title}
              - LoadingContainer:
                  isLoading: ${getDummyProducts.isLoading}
                  widget:
                    Column:
                      children:
        - Card:
            styles:
              maxWidth: unset
              width: unset
              gap: 10
            children:
              - Markdown:
                  text: |
                    ## Flow 

                    It shows with direction **horizontal** and **vertical**
              - Flow:
                  styles:
                    lineGap: 20
                  item-template:
                    data: ${new Array(20).fill(Math.floor(Math.random() * 100))}
                    name: flowChild
                    template:
                      Column:
                        styles:
                          borderColor: green
                          padding: 6
                          borderWidth: 1
                          borderRadius: 12
                        children:
                          - Icon:
                              name: Search
                          - Text:
                              text: ${"Hello" + flowChild}
              - Flow:
                  styles:
                    lineGap: 20
                    direction: vertical
                  item-template:
                    data: ${new Array(10).fill(Math.floor(Math.random() * 100))}
                    name: flowChild
                    template:
                      Column:
                        styles:
                          borderColor: green
                          padding: 6
                          borderWidth: 1
                          borderRadius: 12
                        children:
                          - Icon:
                              name: Search
                          - Text:
                              text: ${"Hello" + flowChild}

  footer:
    children:
      - Text:
          text: Give support us
    styles:
      backgroundColor: red

API:
  getDummyProducts:
    method: GET
    uri: https://dummyjson.com/products?skip=${skip}&limit=10
    inputs:
      - skip
